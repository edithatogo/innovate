<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Handling Seasonal Data with Diffusion Models &#8212; innovate  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="handling-seasonal-data-with-diffusion-models">
<span id="seasonal-data-tutorial"></span><h1>Handling Seasonal Data with Diffusion Models<a class="headerlink" href="#handling-seasonal-data-with-diffusion-models" title="Link to this heading">¶</a></h1>
<p>Real-world data often exhibits seasonality, which can violate the assumptions of simple diffusion models. This tutorial demonstrates how to use the <code class="docutils literal notranslate"><span class="pre">innovate</span></code> library in combination with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> to handle seasonal data by decomposing a time series into its trend, seasonal, and residual components.</p>
<section id="introduction-to-seasonal-decomposition">
<h2>Introduction to Seasonal Decomposition<a class="headerlink" href="#introduction-to-seasonal-decomposition" title="Link to this heading">¶</a></h2>
<p>Seasonal decomposition is a statistical technique that separates a time series into three components:</p>
<ul class="simple">
<li><p><strong>Trend</strong>: The underlying long-term movement in the data.</p></li>
<li><p><strong>Seasonality</strong>: The repeating short-term cycles in the data.</p></li>
<li><p><strong>Residuals</strong>: The random, irregular fluctuations in the data.</p></li>
</ul>
<p>By decomposing the time series, we can isolate the trend component and fit our diffusion model to it. This allows the model to capture the underlying diffusion process without being confounded by seasonality.</p>
</section>
<section id="a-simple-example-fitting-a-logistic-model-to-a-seasonal-time-series">
<h2>A Simple Example: Fitting a Logistic Model to a Seasonal Time Series<a class="headerlink" href="#a-simple-example-fitting-a-logistic-model-to-a-seasonal-time-series" title="Link to this heading">¶</a></h2>
<p>Let’s walk through an example of fitting a <code class="docutils literal notranslate"><span class="pre">LogisticModel</span></code> to some synthetic seasonal data.</p>
<section id="generate-seasonal-data">
<h3>1. Generate Seasonal Data<a class="headerlink" href="#generate-seasonal-data" title="Link to this heading">¶</a></h3>
<p>First, we’ll generate some synthetic data with a clear seasonal pattern.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">innovate.diffuse</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">innovate.fitters</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumpyroFitter</span>

<span class="c1"># Generate a time series with a seasonal component</span>
<span class="n">t_seasonal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">seasonal_component</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t_seasonal</span> <span class="o">/</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">trend_component</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t_seasonal</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y_seasonal</span> <span class="o">=</span> <span class="n">trend_component</span> <span class="o">+</span> <span class="n">seasonal_component</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_seasonal</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_seasonal</span><span class="p">,</span> <span class="n">y_seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="decompose-the-time-series">
<h3>2. Decompose the Time Series<a class="headerlink" href="#decompose-the-time-series" title="Link to this heading">¶</a></h3>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">seasonal_decompose</span></code> function from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> to separate the trend from the seasonal component.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Decompose the time series</span>
<span class="n">decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">y_seasonal</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">trend</span>
<span class="n">seasonal</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span>
<span class="n">residual</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># Plot the decomposition</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residual&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="fit-the-model-to-the-trend">
<h3>3. Fit the Model to the Trend<a class="headerlink" href="#fit-the-model-to-the-trend" title="Link to this heading">¶</a></h3>
<p>Now, we can fit our diffusion model to the extracted trend component. This allows the model to capture the underlying diffusion process without being confounded by seasonality.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the trend component</span>
<span class="c1"># Note: We need to remove the NaNs from the trend component</span>

<span class="n">t_trend</span> <span class="o">=</span> <span class="n">t_seasonal</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">trend</span><span class="p">)]</span>
<span class="n">y_trend</span> <span class="o">=</span> <span class="n">trend</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">trend</span><span class="p">)]</span>

<span class="n">model_for_trend</span> <span class="o">=</span> <span class="n">LogisticModel</span><span class="p">()</span>
<span class="n">fitter_for_trend</span> <span class="o">=</span> <span class="n">NumpyroFitter</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_for_trend</span><span class="p">,</span> <span class="n">num_warmup</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fitter_for_trend</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">t_trend</span><span class="p">,</span> <span class="n">y_trend</span><span class="p">)</span>

<span class="c1"># Get the parameter estimates for the trend</span>
<span class="n">trend_params</span> <span class="o">=</span> <span class="n">fitter_for_trend</span><span class="o">.</span><span class="n">get_parameter_estimates</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameter Estimates for the Trend:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trend_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>By using STL decomposition, you can extend the applicability of diffusion models to seasonal data, allowing you to model the underlying growth dynamics even in the presence of periodic fluctuations. This is a powerful technique for improving the accuracy of your diffusion models when dealing with real-world data.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">innovate</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../innovate.html">innovate package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../innovate.diffuse.html">innovate.diffuse package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.compete.html">innovate.compete package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.substitute.html">innovate.substitute package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.hype.html">innovate.hype package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.fail.html">innovate.fail package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.adopt.html">innovate.adopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.path_dependence.html">innovate.path_dependence package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.policy.html">innovate.policy package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.abm.html">innovate.abm</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../innovate.plots.html">innovate.plots package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.utils.html">innovate.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.utils.html#module-innovate.adopt.categorization">innovate.adopt.categorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.fitters.html">innovate.fitters package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../innovate.base.html">innovate.base package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Doughnut.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/tutorials/seasonal_data_tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>